// components/vulnerability/RiskMeter.tsx
import React from 'react';
import { DashboardStats, Vulnerability } from '../../types/vulnerability';

interface RiskMeterProps {
  stats: DashboardStats;
  recentFindings: Vulnerability[];
}

const RiskMeter: React.FC<RiskMeterProps> = ({ stats, recentFindings }) => {
  const criticalCount = recentFindings.filter(f => f.severity === 'CRITICAL').length;
  const highCount = recentFindings.filter(f => f.severity === 'HIGH').length;
  
  const getOverallRisk = () => {
    if (criticalCount > 0) return { level: 'CRITICAL', color: 'text-error', bg: 'bg-error' };
    if (highCount > 0) return { level: 'HIGH', color: 'text-warning', bg: 'bg-warning' };
    if (stats.alerts > 0) return { level: 'MEDIUM', color: 'text-info', bg: 'bg-info' };
    return { level: 'LOW', color: 'text-success', bg: 'bg-success' };
  };

  const risk = getOverallRisk();

  return (
    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
      {/* Overall Risk */}
      <div className="card bg-base-100 shadow-lg">
        <div className="card-body text-center">
          <div className="text-sm text-gray-500 mb-2">Overall Risk</div>
          <div className={`text-3xl font-bold ${risk.color} mb-2`}>
            {risk.level}
          </div>
          <div className="text-xs text-gray-500">
            {criticalCount > 0 ? `${criticalCount} critical issues` : 'No critical issues'}
          </div>
        </div>
      </div>

      {/* Active Scans */}
      <div className="card bg-base-100 shadow-lg">
        <div className="card-body text-center">
          <div className="text-sm text-gray-500 mb-2">Active Scans</div>
          <div className="text-3xl font-bold text-primary mb-2">
            {stats.activeScans}
          </div>
          <div className="text-xs text-gray-500">
            {stats.activeScans > 0 ? 'Running now' : 'No active scans'}
          </div>
        </div>
      </div>

      {/* Critical Alerts */}
      <div className="card bg-base-100 shadow-lg">
        <div className="card-body text-center">
          <div className="text-sm text-gray-500 mb-2">Critical Alerts</div>
          <div className="text-3xl font-bold text-error mb-2">
            {stats.alerts}
          </div>
          <div className="text-xs text-gray-500">
            Requiring immediate attention
          </div>
        </div>
      </div>

      {/* Success Rate */}
      <div className="card bg-base-100 shadow-lg">
        <div className="card-body text-center">
          <div className="text-sm text-gray-500 mb-2">Success Rate</div>
          <div className="text-3xl font-bold text-success mb-2">
            {stats.successRate}%
          </div>
          <div className="text-xs text-gray-500">
            Completed successfully
          </div>
        </div>
      </div>
    </div>
  );
};

export default RiskMeter;