export interface Vulnerability {
  type: string;
  severity: 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW' | 'INFO';
  description: string;
  recommendation: string;
  evidence?: string;
  cvss_score?: number;
  cve_id?: string;
  source?: string;
  id: string;
  title: string;
  asset_id: string;
  scan_job_id: string;
  status: string;
  discovered_at: string;
}

export interface WebSecurityFindings {
  vulnerabilities: Vulnerability[];
  risk_assessment: RiskAssessment;
}

export interface SSLSecurityFindings {
  certificate_info: CertificateInfo;
  protocol_info: ProtocolInfo;
  vulnerabilities: Vulnerability[];
  security_score: number;
}

export interface CVEAnalysis {
  results: ServiceVulnerability[];
  summary: {
    services_scanned: number;
    vulnerable_services: number;
    total_vulnerabilities: number;
  };
}

export interface CredentialTestResult {
  service: string;
  host: string;
  port: number;
  credentials_tested: number;
  vulnerable_credentials: Array<{
    username: string;
    password: string;
    service: string;
    severity: string;
  }>;
  recommendations: string[];
}

export interface ServiceVulnerability {
  service: {
    name: string;
    version: string;
    host: string;
    port: number;
  };
  vulnerabilities: Vulnerability[];
  risk_assessment: RiskAssessment;
}

export interface RiskAssessment {
  risk_score: number;
  risk_level: string;
  critical_count: number;
  high_count: number;
  medium_count: number;
  low_count: number;
  total_vulnerabilities: number;
  overall_score?: number;
}

export interface OverallRiskAssessment {
  overall_score: number;
  risk_level: string;
  component_scores: {
    web_security: number;
    ssl_security: number;
    cve_analysis: number;
  };
}

export interface CertificateInfo {
  subject: Record<string, string>;
  issuer: Record<string, string>;
  not_before: string;
  not_after: string;
  has_expired: boolean;
  days_until_expiry: number;
  signature_algorithm: string;
}

export interface ProtocolInfo {
  supported_protocols: Record<string, boolean>;
  weak_protocols_enabled: boolean;
  recommended_protocols: string[];
}

export interface ScanDetails {
  web_security?: WebSecurityFindings;
  ssl_security?: SSLSecurityFindings;
  cve_analysis?: CVEAnalysis;
  credential_testing?: CredentialTestResult;
  overall_risk?: OverallRiskAssessment;
  assessment_type?: 'full' | 'web_security' | 'ssl_analysis' | 'cve_scan' | 'credential_testing';
  target?: string;
  summary?: {
    vulnerabilities_found: number;
    risk_level: string;
    risk_score: number;
  };
}

export interface ScanResult {
  id: string;
  target: string;
  risk_level: string;
  vulnerabilities_found: number;
  security_score: number;
  scan_date: string;
  details?: ScanDetails;
  scan_type: string;
}

export interface ScanJob {
  id: string;
  target: string;
  scan_type: string;
  profile: string;
  status: 'queued' | 'running' | 'finished' | 'failed'; // Changed from 'completed' to 'finished'
  progress: number;
  created_at: string;
  updated_at: string;
  finished_at?: string;
  duration?: number;
  log?: string;
  error?: string;
  error_message?: string;
  asset_id?: string;
  insights?: any;
  vulnerability_results?: any;
  config?: any;
  parent_scan_id?: string;
  type?: string;
}

export interface ScanConfig {
  target: string;
  assessment_type: 'vulnerability_assessment' | 'web_security' | 'ssl_analysis' | 'cve_scan' | 'web_scan'| 'credential_testing';
  aggressive: boolean;
}

export interface CredentialConfig {
  target: string;
  service_type: 'ssh' | 'ftp' | 'mysql' | 'telnet';
  port: number;
}

export interface DashboardStats {
  activeScans: number;
  completedJobs: number;
  systemLoad: number;
  alerts: number;
  totalScans?: number;
  successRate?: number;
}

// Define a generic paginated structure
export interface Paginator<T> {
  total: number;
  pages: number;
  current_page: number;
  // The list property will change based on the API endpoint
  // We'll define two specific ones below
}

// 1. For the Scans endpoint (resolves the 'data' error)
export interface PaginatedScanJobs {
  scans: ScanJob[]; // <-- This is the list property the API uses
  total: number;
  pages: number;
  current_page: number;
}

// 2. For the Vulnerabilities endpoint (resolves the 'results' error)
export interface PaginatedVulnerabilities {
  vulnerabilities: Vulnerability[]; // <-- This is the list property the API uses
  total: number;
  pages: number;
  current_page: number;
}